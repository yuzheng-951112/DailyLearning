第九章 IP选路
9.1 选路的原理
选路步骤：
(1)	搜索匹配的主机地址
(2)	搜索匹配的网络地址
(3)	搜索默认表项
IP执行选路机制，而路由守护程序则一般提供选路策略。
 
对于一个给定的路由器，可以打印出五种不同的flag：
1．	U表示该路由可用。
2．	G表示该路由是一个网关。如果没有这个标志，说明和Destination是直连的，而相应的Gateway应该直接	给出Dwstination的地址。
3．	H表明该路由是到一个主机，如果没有该标志，说明Destination是一个网络，换句话说Destination就应该写成一个网络号和子网络的组合，而不包括主机号(主机号码处为0)，例如192.168.11.0。
4．	D表明该路由是为重定向报文创建的。
5．	M该路由已经被重定向报文修改。
9.2 其他有关路由表的知识
一般，我们在配置好一个网络接口的时候，一个路由就被直接创建好了。当然我们也可以手动添加路由，用route add命令就可以。
当一个IP包在某个路由器发现无路可走时，那么该路由器就会给源主机发送“主机不可达”或者“网络不可达”的ICMP报文报错
一般的操作系统默认是没有路由功能的。
9.3 ICMP的IP重定向报文和路由发现报文
当IP包在某个地方转向的时候，都会给发送IP报的源主机一个ICMP重定向报文，而源主机可以利用这个信息来更新自己的路由表，这样，随着网络通信的逐渐增多，路由表也就越来越完备，数据转发的速度也会越来越快。我们需要注意的是：
1.重定向报文只能由路由器发出。
2.重定向报文为主机所用，而不是为路由器所用。
试验一：重定向试验
 
（a）拓扑图
 
（b）捕捉报

（c）ICMP重定向(类型5，代码1) 
(a)R3(fa0/0 192.168.0.3)：设置回环(1.1.1.1 255.255.255.255)
  R2(fa0/0 192.168.0. 2)：设置静态路由(ip route 1.1.1.1 255.255.255.0 192.168.0.3)
  R1(fa0/0 192.168.0. 1)：设置默认路由(ip route 0.0.0.0 0.0.0.0 192.168.0.2)
(b)ping 1.1.1.1后再R2的fa0/0截取数据包
(d)ICMP重定向报文
